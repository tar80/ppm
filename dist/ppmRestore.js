var e=PPx.CreateObject("Scripting.FileSystemObject"),t={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var e=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===e||"ja"===e?e:t.language},n={initialCfg:"_initial.cfg",globalCfg:"_global.cfg",nopluginCfg:"_noplugin.cfg",pluginList:"_pluginlist",manageFiles:"_managefiles",updateLog:"_updateLog",repoDir:"repo",archDir:"arch",cacheDir:function(){return"cache\\"+PPx.Extract("%0").slice(3).replace(/\\/g,"@")}},isEmptyStr=function(e){return""===e},pathSelf=function(){var e,t,n=PPx.ScriptName;return~n.indexOf("\\")?(e=extractFileName(n),t=PPx.Extract("%*name(DKN,"+n+")")):(e=n,t=PPx.Extract("%FDN")),{scriptName:e,parentDir:t.replace(/\\$/,"")}},extractFileName=function(e,t){return void 0===t&&(t="\\"),"\\"!==t&&"/"!==t&&(t="\\"),e.slice(e.lastIndexOf(t)+1)},dialog=function(e,t,n){return void 0===t&&(t=""),t=isEmptyStr(t)?"":"/"+t,0===PPx.Execute('%"ppm'+t+'" %OC %'+e+'"'+n+'"')},msgBox=function(e,t){dialog("I",""+e,""+t)},r={en:{notExist:" is not exists"},ja:{notExist:" はありません"}},validArgs=function(){for(var e=[],t=PPx.Arguments;!t.atEnd();t.moveNext())e.push(t.value);return e},safeArgs=function(){for(var e=[],t=validArgs(),n=0,r=arguments.length;n<r;n++)e.push(_valueConverter(n<0||arguments.length<=n?undefined:arguments[n],t[n]));return e},_valueConverter=function(e,t){if(null==t||""===t)return null!=e?e:undefined;switch(typeof e){case"number":var n=Number(t);return Number.isNaN(n)?e:n;case"boolean":return null!=t&&"false"!==t&&"0"!==t;default:return t}},i=pathSelf().scriptName,u=r[useLanguage()];(function(){var t=safeArgs("",""),r=t[0],a=t[1];e.FolderExists(r)||(msgBox(i,r+" "+u.notExist),PPx.Quit(-1)),e.FolderExists(a)||(msgBox(i,a+" "+u.notExist),PPx.Quit(-1)),PPx.Execute("*string u,ppmcache="+r),PPx.Execute("*setcust @"+r+"\\ppm\\"+n.globalCfg),PPx.Execute("*script "+a+"\\dist\\pluginRegister.js,all,restore,user")})();
