var t=PPx.CreateObject("Scripting.FileSystemObject"),e={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"ja"===t?t:e.language},n={initialCfg:"_initial.cfg",globalCfg:"_global.cfg",nopluginCfg:"_noplugin.cfg",pluginList:"_pluginlist",manageFiles:"_managefiles",updateLog:"_updateLog",repoDir:"repo",archDir:"arch",cacheDir:function(){return"cache\\"+PPx.Extract("%0").slice(3).replace(/\\/g,"@")}},isEmptyStr=function(t){return""===t},pathSelf=function(){var t,e,n=PPx.ScriptName;return~n.indexOf("\\")?(t=n.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+n+")")):(t=n,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}},dialog=function(t,e,n){return void 0===e&&(e=""),e=isEmptyStr(e)?"":"/"+e,0===PPx.Execute('%"ppm'+e+'" %OC %'+t+'"'+n+'"')},msgBox=function(t,e){dialog("I",""+t,""+e)},r={en:{notEnoughArgument:"Not enough arguments",notExist:" is not exists",restart:"Restart PPc"},ja:{notEnoughArgument:"引数が足りません",notExist:" はありません",restart:"再起動します"}},a=pathSelf().scriptName,i=r[useLanguage()],p=function(){var e=["",""],n=PPx.Arguments.length;if(n<2)return i.notEnoughArgument;for(var r=0;r<n;r++)if(e[r]=PPx.Argument(r),!t.FolderExists(e[r]))return e[r]+" "+i.notExist;return{ppmcache:e[0],ppmDir:e[1]}}();"string"==typeof p&&(msgBox(a,p),PPx.Quit(-1)),PPx.Execute("*string u,ppmcache="+p.ppmcache),PPx.Execute("*setcust @"+p.ppmcache+"\\ppm\\"+n.globalCfg),PPx.Execute("*script "+p.ppmDir+"\\dist\\pluginRegister.js,all,restore,user");
