var t=PPx.CreateObject("Scripting.FileSystemObject"),e="jp",r="_global.cfg",n=function(){var t,e,r=PPx.ScriptName;return~r.indexOf("\\")?(t=r.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+r+")")):(t=r,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}}(),c=n.scriptName,i={en:{notEnoughArgument:"Not enough arguments",notExist:" is not exists",restart:"Restart PPc"},jp:{notEnoughArgument:"引数が足りません",notExist:" はありません",restart:"再起動します"}}[function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"jp"===t?t:e}()],p=function(e){void 0===e&&(e=PPx.Arguments);var r=["",""],n=e.length;if(n<2)return i.notEnoughArgument;for(var c=0;c<n;c++)if(r[c]=e.Item(c),!t.FolderExists(r[c]))return r[c]+" "+i.notExist;return{ppmcache:r[0],ppmDir:r[1]}}();"string"==typeof p&&(function(t,e,r){void 0===e&&(e=""),e=""===e?"":"/"+e,PPx.Execute('%"ppm'+e+'" %OC %'+t+'"'+r+'"')}("I",""+c,""+p),PPx.Quit(-1)),PPx.Execute("*string u,ppmcache="+p.ppmcache),PPx.Execute("*setcust @"+p.ppmcache+"\\ppm\\"+r),PPx.Execute("*script "+p.ppmDir+"\\dist\\pluginRegister.js,all,restore,user");
