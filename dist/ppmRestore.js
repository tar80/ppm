var e=PPx.CreateObject("Scripting.FileSystemObject"),t={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var e=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===e||"ja"===e?e:t.language},n={initialCfg:"_initial.cfg",globalCfg:"_global.cfg",nopluginCfg:"_noplugin.cfg",pluginList:"_pluginlist",manageFiles:"_managefiles",updateLog:"_updateLog",repoDir:"repo",archDir:"arch",cacheDir:function(){return"cache\\"+PPx.Extract("%0").slice(3).replace(/\\/g,"@")}},isEmptyStr=function(e){return""===e},pathSelf=function(){var e,t,n=PPx.ScriptName;return~n.indexOf("\\")?(e=n.replace(/^.*\\/,""),t=PPx.Extract("%*name(DKN,"+n+")")):(e=n,t=PPx.Extract("%FDN")),{scriptName:e,parentDir:t.replace(/\\$/,"")}},dialog=function(e,t,n){return void 0===t&&(t=""),t=isEmptyStr(t)?"":"/"+t,0===PPx.Execute('%"ppm'+t+'" %OC %'+e+'"'+n+'"')},msgBox=function(e,t){dialog("I",""+e,""+t)},r={en:{notEnoughArgument:"Not enough arguments",notExist:" is not exists",restart:"Restart PPc"},ja:{notEnoughArgument:"引数が足りません",notExist:" はありません",restart:"再起動します"}},a=pathSelf().scriptName,i=r[useLanguage()],c=function(){var t=["",""],n=PPx.Arguments.length;if(n<2)return i.notEnoughArgument;for(var r=0;r<n;r++)if(t[r]=PPx.Argument(r),!e.FolderExists(t[r]))return t[r]+" "+i.notExist;return{ppmcache:t[0],ppmDir:t[1]}}();"string"==typeof c&&(msgBox(a,c),PPx.Quit(-1)),PPx.Execute("*string u,ppmcache="+c.ppmcache),PPx.Execute("*setcust @"+c.ppmcache+"\\ppm\\"+n.globalCfg),PPx.Execute("*script "+c.ppmDir+"\\dist\\pluginRegister.js,all,restore,user");
