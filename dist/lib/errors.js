var r={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var n=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===n||"ja"===n?n:r.language},isEmptyStr=function(r){return""===r},pathSelf=function(){var r,n,e=PPx.ScriptName;return~e.indexOf("\\")?(r=e.replace(/^.*\\/,""),n=PPx.Extract("%*name(DKN,"+e+")")):(r=e,n=PPx.Extract("%FDN")),{scriptName:r,parentDir:n.replace(/\\$/,"")}},n=PPx.CreateObject("Scripting.FileSystemObject"),expandNlCode=function(r){var n="\n",e=r.indexOf("\r");return~e&&(n="\r\n"==r.substring(e,e+2)?"\r\n":"\r"),n},exec=function(r,n){try{var e;return[!1,null!=(e=n())?e:""]}catch(t){return[!0,""]}finally{r.Close()}},read=function(r){var e=r.path,t=r.enc,a=void 0===t?"utf8":t;if(!n.FileExists(e))return[!0,e+" not found"];var u=n.GetFile(e);if(0===u.Size)return[!0,e+" has no data"];var i=!1,s="";if("utf8"===a){var o=PPx.CreateObject("ADODB.Stream"),l=exec(o,(function(){return o.Open(),o.Charset="UTF-8",o.LoadFromFile(e),o.ReadText(-1)}));i=l[0],s=l[1]}else{var g="utf16le"===a?-1:0,c=u.OpenAsTextStream(1,g),f=exec(c,(function(){return c.ReadAll()}));i=f[0],s=f[1]}return i?[!0,"Unable to read "+e]:[!1,s]},readLines=function(r){var n,e=r.path,t=r.enc,a=void 0===t?"utf8":t,u=r.linefeed,i=read({path:e,enc:a}),s=i[0],o=i[1];if(s)return[!0,o];u=null!=(n=u)?n:expandNlCode(o.slice(0,1e3));var l=o.split(u);return isEmptyStr(l[l.length-1])&&l.pop(),[!1,{lines:l,nl:u}]},validArgs=function(){for(var r=[],n=PPx.Arguments;!n.atEnd();n.moveNext())r.push(n.value);return r},safeArgs=function(){for(var r=[],n=validArgs(),e=0,t=arguments.length;e<t;e++)r.push(_valueConverter(e<0||arguments.length<=e?undefined:arguments[e],n[e]));return r},_valueConverter=function(r,n){if(null==n||""===n)return null!=r?r:undefined;switch(typeof r){case"number":var e=Number(n);return isNaN(e)?r:e;case"boolean":return"false"!==n&&"0"!==n&&null!=n;default:return n}},e=pathSelf(),t=e.scriptName,a=e.parentDir,main=function(){var r=safeArgs("arg",undefined,""),n=r[0],e=r[1],t=r[2];e||(errorMsg(u.notEnough+"\n"+u.error),PPx.Quit(1));var a=fileDetails(e);PPx.Echo(i[n](a.path,a.name,t))},u={en:{notEnough:"Not enough arguments",error:'\n @arg 0 {string} - Specify method. "arg" | "msg"\n @arg 1 {string} - Path of target script\n @arg 2 {string} - Error message for method \'msg\'\n\n Mothod "arg" displays argument details.\n        "msg" displays the error message'},ja:{notEnough:"引数が間違っています",error:'\n @arg 0 {string} - 実行するメソッド: "arg | "msg"\n @arg 1 {string} - 対象とするスクリプトのパス\n @arg 2 {string} - メソッド"msg"を指定したときに表示するメッセージ\n\n メソッド "arg" 引数の詳細を表示します\n          "msg" エラーメッセージを表示します'}}[useLanguage()],errorMsg=function(r){return PPx.Echo(t+": "+r)},fileDetails=function(r){var n=~r.indexOf("\\")?r.replace(/^(.+)\\(.+)$/,"$1;$2").split(";"):[a,r],e=n[0],t=n[1];return/^.*[\/\\]dist[\/\\].*\.js$/.test(r=e+"\\"+t)&&(r=r.replace(/(dist|\.js$)/g,(function(r,n){return{dist:"src",".js":".ts"}[n]}))),{path:r,name:t}},i={arg:function(r,n,e){var t=[n+": "+u.notEnough,""],a=/^\s\*\s(@args?\s.+)$/,i=readLines({path:r}),s=i[0],o=i[1];if(s)throw new Error(o);for(var l=0,g=o.lines.length;l<g;l++){var c=o.lines[l];a.test(c)&&t.push(c.replace(a,"$1"))}return t.join(o.nl)},msg:function(r,n,e){return n+": "+e}};main();
