var n={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},r={actions:"S_ppm#actions",event:"S_ppm#event",global:"S_ppm#global",sources:"S_ppm#sources",staymode:"S_ppm#staymode",user:"S_ppm#user"},useLanguage=function(){var e=PPx.Extract("%*getcust("+r.global+":lang)");return"en"===e||"ja"===e?e:n.language},isEmptyStr=function(n){return""===n},pathSelf=function(){var n,r,e=PPx.ScriptName;return~e.indexOf("\\")?(n=extractFileName(e),r=PPx.Extract("%*name(DKN,"+e+")")):(n=e,r=PPx.Extract("%FDN")),{scriptName:n,parentDir:r.replace(/\\$/,"")}},extractFileName=function(n,r){return void 0===r&&(r="\\"),"\\"!==r&&"/"!==r&&(r="\\"),n.slice(n.lastIndexOf(r)+1)},e=PPx.CreateObject("Scripting.FileSystemObject"),expandNlCode=function(n){var r="\n",e=n.indexOf("\r");return~e&&(r="\r\n"===n.substring(e,e+2)?"\r\n":"\r"),r},_exec=function(n,r){try{var e;return[!1,null!=(e=r())?e:""]}catch(t){return[!0,""]}finally{n.Close()}},read=function(n){var r=n.path,t=n.enc,a=void 0===t?"utf8":t;if(!e.FileExists(r))return[!0,r+" not found"];var u=e.GetFile(r);if(0===u.Size)return[!0,r+" has no data"];var i=!1,s="";if("utf8"===a){var o=PPx.CreateObject("ADODB.Stream"),l=_exec(o,(function(){return o.Open(),o.Charset="UTF-8",o.LoadFromFile(r),o.ReadText(-1)}));i=l[0],s=l[1]}else{var c="utf16le"===a?-1:0,g=u.OpenAsTextStream(1,c),p=_exec(g,(function(){return g.ReadAll()}));i=p[0],s=p[1]}return i?[!0,"Unable to read "+r]:[!1,s]},readLines=function(n){var r,e=n.path,t=n.enc,a=void 0===t?"utf8":t,u=n.linefeed,i=read({path:e,enc:a}),s=i[0],o=i[1];if(s)return[!0,o];u=null!=(r=u)?r:expandNlCode(o.slice(0,1e3));var l=o.split(u);return isEmptyStr(l[l.length-1])&&l.pop(),[!1,{lines:l,nl:u}]},validArgs=function(){for(var n=[],r=PPx.Arguments;!r.atEnd();r.moveNext())n.push(r.value);return n},safeArgs=function(){for(var n=[],r=validArgs(),e=0,t=arguments.length;e<t;e++)n.push(_valueConverter(e<0||arguments.length<=e?undefined:arguments[e],r[e]));return n},_valueConverter=function(n,r){if(null==r||""===r)return null!=n?n:undefined;switch(typeof n){case"number":var e=Number(r);return isNaN(e)?n:e;case"boolean":return null!=r&&"false"!==r&&"0"!==r;default:return r}},t=pathSelf(),a=t.scriptName,u=t.parentDir,main=function(){var n=safeArgs("arg",undefined,""),r=n[0],e=n[1],t=n[2];e||(errorMsg(i.notEnough+"\n"+i.error),PPx.Quit(1));var a=fileDetails(e);PPx.Echo(s[r](a.path,a.name,t))},i={en:{notEnough:"Not enough arguments",error:'\n @arg 0 {string} - Specify method. "arg" | "msg"\n @arg 1 {string} - Path of target script\n @arg 2 {string} - Error message for method \'msg\'\n\n Mothod "arg" displays argument details.\n        "msg" displays the error message'},ja:{notEnough:"引数が間違っています",error:'\n @arg 0 {string} - 実行するメソッド: "arg | "msg"\n @arg 1 {string} - 対象とするスクリプトのパス\n @arg 2 {string} - メソッド"msg"を指定したときに表示するメッセージ\n\n メソッド "arg" 引数の詳細を表示します\n          "msg" エラーメッセージを表示します'}}[useLanguage()],errorMsg=function(n){return PPx.Echo(a+": "+n)},fileDetails=function(n){var r=~n.indexOf("\\")?n.replace(/^(.+)\\(.+)$/,"$1;$2").split(";"):[u,n],e=r[0],t=r[1];return/^.*[\/\\]dist[\/\\].*\.js$/.test(n=e+"\\"+t)&&(n=n.replace(/(dist|\.js$)/g,(function(n,r){return{dist:"src",".js":".ts"}[r]}))),{path:n,name:t}},s={arg:function(n,r,e){var t=[r+": "+i.notEnough,""],a=/^\s\*\s(@args?\s.+)$/,u=readLines({path:n}),s=u[0],o=u[1];if(s)throw new Error(o);for(var l=0,c=o.lines.length;l<c;l++){var g=o.lines[l];a.test(g)&&t.push(g.replace(a,"$1"))}return t.join(o.nl)},msg:function(n,r,e){return r+": "+e}};main();
