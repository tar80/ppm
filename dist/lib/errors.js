var r="jp",t=PPx.CreateObject("Scripting.FileSystemObject"),n=function(r,t){try{var n;return[!1,null!=(n=t())?n:""]}catch(e){return[!0,""]}finally{r.Close()}},e=function(r){var e,a,s,i,o=r.path,g=r.enc,u=void 0===g?"utf8":g,c=r.linefeed,l=function(r){var e=r.path,a=r.enc,s=void 0===a?"utf8":a;if(!t.FileExists(e))return[!0,e+" not found"];var i=t.GetFile(e);if(0===i.Size)return[!0,e+" has no data"];var o=!1,g="";if("utf8"===s){var u=PPx.CreateObject("ADODB.Stream"),c=n(u,(function(){return u.Open(),u.Charset="UTF-8",u.LoadFromFile(e),u.ReadText(-1)}));o=c[0],g=c[1]}else{var l="utf16le"===s?-1:0,f=i.OpenAsTextStream(1,l),m=n(f,(function(){return f.ReadAll()}));o=m[0],g=m[1]}return o?[!0,"Unable to read "+e]:[!1,g]}({path:o,enc:u}),f=l[0],m=l[1];if(f)return[!0,m];c=null!=(e=c)?e:(a=m.slice(0,1e3),s="\n",~(i=a.indexOf("\r"))&&(s="\r\n"==a.substring(i,i+2)?"\r\n":"\r"),s);var p=m.split(c);return""===p[p.length-1]&&p.pop(),[!1,{lines:p,nl:c}]},a=function(){var r,t,n=PPx.ScriptName;return~n.indexOf("\\")?(r=n.replace(/^.*\\/,""),t=PPx.Extract("%*name(DKN,"+n+")")):(r=n,t=PPx.Extract("%FDN")),{scriptName:r,parentDir:t.replace(/\\$/,"")}}(),s=a.scriptName,i=a.parentDir,o={en:{notEnough:"Not enough arguments",error:'\n @arg 0 {string} - Specify method. "arg" | "msg"\n @arg 1 {string} - Path of target script\n @arg 2 {string} - Error message for method \'msg\'\n\n Mothod "arg" displays argument details.\n        "msg" displays the error message'},jp:{notEnough:"引数が足りません",error:'\n @arg 0 {string} - 実行するメソッド: "arg | "msg"\n @arg 1 {string} - 対象とするスクリプトのパス\n @arg 2 {string} - メソッド"msg"を指定したときに表示するメッセージ\n\n メソッド "arg" 引数の詳細を表示します\n          "msg" エラーメッセージを表示します'}}[function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"jp"===t?t:r}()],g=function(r){return PPx.Echo(s+": "+r)},u=function(r){void 0===r&&(r=PPx.Arguments);for(var t=["arg","",""],n=0,e=r.length;n<e;n++)t[n]=r(n);var a=~t[1].indexOf("\\")?t[1].replace(/^(.+)\\(.+)$/,"$1;$2").split(";"):[i,t[1]],s=a[0],o=a[1],g=s+"\\"+o;return/\.js$/.test(g)&&(g=g.replace(/(dist|\.js$)/g,(function(r,t){return{dist:"src",".js":".ts"}[t]}))),{method:t[0],message:t[2],name:o,path:g}},c={arg:function(r){var t=[r.name+": "+o.notEnough,""],n=/^\s\*\s(@args?\s.+)$/,a=e({path:r.path}),s=a[0],i=a[1];if(function(r,t){return r&&"string"==typeof t}(s,i))throw new Error(i);for(var g=0,u=i.lines.length;g<u;g++){var c=i.lines[g];n.test(c)&&t.push(c.replace(n,"$1"))}return t.join(i.nl)},msg:function(r){return r.name+": "+r.message}};!function(){PPx.Arguments.length<2&&(g(o.notEnough+"\n"+o.error),PPx.Quit(1));var r=u();"arg"!==r.method&&"msg"!==r.method&&(g(o.error),PPx.Quit(1)),PPx.Echo(c[r.method](r))}();
