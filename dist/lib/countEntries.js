var r,e=PPx.CreateObject("Scripting.FileSystemObject"),validArgs=function(){for(var r=[],e=PPx.Arguments;!e.atEnd();e.moveNext())r.push(e.value);return r},safeArgs=function(){for(var r=[],e=validArgs(),t=0,n=arguments.length;t<n;t++)r.push(_valueConverter(t<0||arguments.length<=t?undefined:arguments[t],e[t]));return r},_valueConverter=function(r,e){if(null==e||""===e)return null!=r?r:undefined;switch(typeof r){case"number":var t=Number(e);return Number.isNaN(t)?r:t;case"boolean":return null!=e&&"false"!==e&&"0"!==e;default:return e}},pathSelf=function(){var r,e,t=PPx.ScriptName;return~t.indexOf("\\")?(r=extractFileName(t),e=PPx.Extract("%*name(DKN,"+t+")")):(r=t,e=PPx.Extract("%FDN")),{scriptName:r,parentDir:e.replace(/\\$/,"")}},extractFileName=function(r,e){return void 0===e&&(e="\\"),"\\"!==e&&"/"!==e&&(e="\\"),r.slice(r.lastIndexOf(e)+1)},main=function(){var r=safeArgs(PPx.Extract("%FD"),"both",0),e=r[0],n=r[1],u=r[2],a=n.toLowerCase();if(!isSearchSpec(a)){var i=pathSelf(),o=i.scriptName,c=i.parentDir;PPx.Execute('*script "'+c+'\\errors.js",arg,'+o),PPx.Quit(-1)}return t(e,n,u)},isSearchSpec=function(r){return"both"===r||"file"===r||"dir"===r},t=(r=0,function(n,u,a){if(a<=r)return r;var i=e.GetFolder(n),o=i.SubFolders;"file"!==u&&(r+=o.Count),"dir"!==u&&(r+=i.Files.Count);for(var c=PPx.Enumerator(o);!c.atEnd();c.moveNext())t(c.Item(),u,a);return r});PPx.result=main();
