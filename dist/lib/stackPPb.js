var t,e,r,n;Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(o){if("function"!=typeof o&&("object"!=typeof o||null==o))throw new Error("Object.keys: called on non-object");var i,u,c=[];for(i in o)t.call(o,i)&&c.push(i);if(e)for(u=0;u<n;u++)t.call(o,r[u])&&c.push(r[u]);return c}));var validArgs=function(){for(var t=[],e=PPx.Arguments;!e.atEnd();e.moveNext())t.push(e.value);return t},isEmptyStr=function(t){return""===t},isZero=function(t){return null!=t&&("0"===t||0===t)},pathSelf=function(){var t,e,r=PPx.ScriptName;return~r.indexOf("\\")?(t=r.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+r+")")):(t=r,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}},o={J:0,K:1,L:2,M:3,N:4},i=400,u=10,c=10,a=50,p="ppm_stackppb",s=Number(PPx.Extract("%*getcust(S_ppm#global:disp_width)")),x=Number(PPx.Extract("%*getcust(S_ppm#global:disp_height)"))-a,P=Math.floor(x/5);if(isZero(s)||isZero(x)){var f=pathSelf().scriptName;PPx.linemessage("[ERROR] "+f+" required S_ppm#global:disp_width&disp_height"),PPx.Quit(-1)}PPx.Execute("*wait 0,2");var main=function(){if(!(Number(PPx.Extract("%*ppxlist(+B)"))>=c))for(var t=validArgs(),e=t[0],r=t[1],n=PPx.Extract("%n"),i=getDirection(e);;){for(var u=0,a=Object.keys(o);u<a.length;u++){var s=a[u];if(isEmptyStr(siValue(n,s)))return PPx.Execute("*execute "+n+",*string i,"+p+s+"=1"),void stackPPb(n,s,i,r);if("1"===siValue(n,s))return PPx.Execute("*execute "+n+",*string i,"+p+s+"=2"),void stackPPb(n,s,i,r)}var x=1e3+Math.floor(1e3*Math.random());PPx.Execute("*wait "+x+",2")}},siValue=function(t,e){return PPx.Extract("%*extract("+t+",\"%%si'"+p+e+"'\")")},getDirection=function(t){return/^NW|NE|SW|SE$/i.test(t)?t.toUpperCase():"SE"},l={NW:function(t){return[0,P*t]},NE:function(t){return[s-i-u,P*t]},SW:function(t){return[0,P*(4-t)]},SE:function(t){return[s-i-u,P*(4-t)]}},stackPPb=function(t,e,r,n){var u=o[e],c=l[r](u),a="-breakjob -newgroup -noppb -nostartmsg -noactive -wait:no",s="-bootid:"+e+" -q",x="*windowsize %N,"+i+","+P,f="*execute "+t+",*string i,"+p+e+"=%:*closeppx %n";PPx.Execute("*setcust _WinPos:B"+e+"="+c.join(",")+","+i+","+P+",0"),PPx.Execute("*run "+a+" %0ppbw.exe "+s+" -k %("+x+"%:"+n+"%&"+f+"%)")};main();
