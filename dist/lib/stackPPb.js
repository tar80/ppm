var t,e,r,n;Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(i){if("function"!=typeof i&&("object"!=typeof i||null==i))throw new Error("Object.keys: called on non-object");var o,a,c=[];for(o in i)t.call(i,o)&&c.push(o);if(e)for(a=0;a<n;a++)t.call(i,r[a])&&c.push(r[a]);return c}));var validArgs=function(){for(var t=[],e=PPx.Arguments;!e.atEnd();e.moveNext())t.push(e.value);return t},isEmptyStr=function(t){return""===t},isZero=function(t){return null!=t&&("0"===t||0===t)},pathSelf=function(){var t,e,r=PPx.ScriptName;return~r.indexOf("\\")?(t=r.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+r+")")):(t=r,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}},i={J:0,K:1,L:2,M:3,N:4},o=400,a=10,c=10,u=50,x="ppm_stackppb",P=Number(PPx.Extract("%*getcust(S_ppm#global:disp_width)")),p=Number(PPx.Extract("%*getcust(S_ppm#global:disp_height)"))-u,s=Math.floor(p/5);if(isZero(P)||isZero(p)){var f=pathSelf().scriptName;PPx.linemessage("[ERROR] "+f+" required S_ppm#global:disp_width&disp_height"),PPx.Quit(-1)}PPx.Execute("*wait 0,2");var main=function(){if(!(Number(PPx.Extract("%*ppxlist(+B)"))>=c)){var t=validArgs(),e=t[0],r=t[1],n=PPx.Extract("%n"),o=getDirection(e);if(!e)return PPx.Execute("*execute "+n+",*string i,"+x+"=break"),PPx.Execute("*wait 2000,2"),void PPx.Execute("*execute "+n+",*string i,"+x+"=");for(;;){for(var a=0,u=Object.keys(i);a<u.length;a++){var P=u[a],p=siValue(n,P);if(isEmptyStr(PPx.Extract("%NB"+P))&&"starting"!==p)return PPx.Execute("*execute "+n+",*string i,"+x+P+"=starting"),void stackPPb(n,P,o,r)}var s=1e3+Math.floor(800*Math.random());if(PPx.Execute("*wait "+s+",2"),"break"===PPx.Extract("%*extract("+n+",\"%%si'"+x+"'\")")){PPx.Echo(111);break}}}},siValue=function(t,e){return PPx.Extract("%*extract("+t+",\"%%si'"+x+e+"'\")")},getDirection=function(t){return/^NW|NE|SW|SE$/i.test(t)?t.toUpperCase():"SE"},l={NW:function(t){return[0,s*t]},NE:function(t){return[P-o-a,s*t]},SW:function(t){return[0,s*(4-t)]},SE:function(t){return[P-o-a,s*(4-t)]}},stackPPb=function(t,e,r,n){var a=i[e],c=l[r](a),u="-breakjob -newgroup -noppb -nostartmsg -noactive -wait:no",P="-bootid:"+e+" -q",p="*windowsize %N,"+o+","+s,f="*execute "+t+",*string i,"+x+e+"=activate",E="*execute "+t+",*string i,"+x+e+"=%:*closeppx %n";PPx.Execute("*setcust _WinPos:B"+e+"="+c.join(",")+","+o+","+s+",0"),PPx.Execute("%OP *run "+u+" %0ppbw.exe "+P+" -k %("+p+"%:"+f+"%:"+n+"%&"+E+"%)")};main();
