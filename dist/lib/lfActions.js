!function(){if("object"!=typeof JSON){JSON={};var t,e,n,r,u=/^[\],:{}\s]*$/,a=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,f=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+p(this.getUTCMonth()+1)+"-"+p(this.getUTCDate())+"T"+p(this.getUTCHours())+":"+p(this.getUTCMinutes())+":"+p(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,u,a){var i;if(t="",e="","number"==typeof a)for(i=0;i<a;i+=1)e+=" ";else"string"==typeof a&&(e=a);if(r=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return l("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var n;if(t=String(t),c.lastIndex=0,c.test(t)&&(t=t.replace(c,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(a,"@").replace(i,"]").replace(o,"")))return n=Function("return ("+t+")")(),"function"==typeof e?function r(t,n){var u,a,i=t[n];if(i&&"object"==typeof i)for(u in i)Object.prototype.hasOwnProperty.call(i,u)&&((a=r(i,u))!==undefined?i[u]=a:delete i[u]);return e.call(t,n,i)}({"":n},""):n;throw new Error("JSON.parse")})}function p(t){return t<10?"0"+t:t}function s(t){return f.lastIndex=0,f.test(t)?'"'+t.replace(f,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function l(n,u){var a,i,o,f,c,p=t,h=u[n];switch(h&&"object"==typeof h&&"function"==typeof h.toJSON&&(h=h.toJSON(n)),"function"==typeof r&&(h=r.call(u,n,h)),typeof h){case"string":return s(h);case"number":return isFinite(h)?String(h):"null";case"boolean":return String(h);case"object":if(!h)return"null";if(t+=e,c=[],"[object Array]"===Object.prototype.toString.apply(h)){for(f=h.length,a=0;a<f;a+=1)c[a]=l(String(a),h)||"null";return o=0===c.length?"[]":t?"[\n"+t+c.join(",\n"+t)+"\n"+p+"]":"["+c.join(",")+"]",t=p,o}if(r&&"object"==typeof r)for(f=r.length,a=0;a<f;a+=1)"string"==typeof r[a]&&(o=l(i=String(r[a]),h))&&c.push(s(i)+(t?": ":":")+o);else for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(o=l(i,h))&&c.push(s(i)+(t?": ":":")+o);return o=0===c.length?"{}":t?"{\n"+t+c.join(",\n"+t)+"\n"+p+"}":"{"+c.join(",")+"}",t=p,o}return"null"}}();var t=PPx.CreateObject("Scripting.FileSystemObject"),e="jp";t.FileExists(PPx.Extract("%OR %FDC"))&&PPx.Quit(1);var n="@#_#@",r={en:{noAction:"No action registered"},jp:{noAction:"対応するコマンドが登録されていません"}}[function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"jp"===t?t:e}()],u=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["*ppv","enclose","0","utf8"],n=0,r=t.length;n<r;n++)e[n]=t.Item(n);return/enclose|escape|double/.test(e[1])||(e[1]="enclose"),/sjis|utf16le|utf8/.test(e[3])||(e[3]="utf8"),{act:e[0],spc:e[1],dup:"0"!==e[2]}},a=function(t){return{enclose:function(t){return'"'+t+'"'},double:function(t){return'""'+t+'""'},escape:function(t){return t.replace(/\s/g,"\\ ")}}[t]},i=function(t){var e,r,u=t.cmdline,a=t.base,i=t.dirtype,o=t.search,f=t.isDup,c=t.entry,p=null!=(e=c.att)?e:"",s=c.hl?String(c.hl):"",l=null!=(r=c.sname)?r:"",h="base:"+a+n+"dirtype:"+i+n+"search:"+o+n+"dup:"+f+n+"path:"+c.path+n+"att:"+p+n+"hl:"+s+n+"sname:"+l;return PPx.Extract('%%OP %*regexp("%('+h+'%)","%(/base:(?<base>.*)@#_#@type:(?<type>.*)@#_#@search(?<search>.*)@#_#@dup:(?<dup>.+)@#_#@path:(?<path>.+)@#_#@att:(?<att>.*)@#_#@hl:(?<hl>.*)@#_#@sname:(?<sname>.*)/'+u+'/%)")')};!function(){var e,o,f,c=function(){var t,e,n=PPx.ScriptName;return~n.indexOf("\\")?(t=n.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+n+")")):(t=n,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}}(),p=c.scriptName,s=u(),l=JSON.parse(PPx.getIValue("meta")),h=PPx.Extract("%*getcust(S_ppm#actions:"+l.ppm+"_"+s.act+")").replace(/[\r\n]/g,(function(t){return{"\r":"%br","\n":"%bl"}[t]}));""===h&&(PPx.report("[ppm/"+p+"] "+r.noAction),PPx.Quit(-1));var g,y="every"===l.freq,P=null!=(e=l.base)?e:"",b=null!=(o=l.dirtype)?o:"",x=null!=(f=l.search)?f:"",d=a(s.spc),S=y?function(t){var e=t.entry,n=t.isDup;return PPx.Execute("%OP- *execute ,"+i({cmdline:h,base:P,dirtype:b,search:x,isDup:n,entry:e}))}:function(t){var e=t.entry;return O.push(e.path)},O=[],m={},v=PPx.Entry;v.FirstMark;do{var j={att:v.Attributes,hl:v.Highlight,path:P+"\\"+v.Comment,sname:v.ShortName};t.FileExists(j.path)&&(~j.path.indexOf(" ")&&(j.path=d(j.path)),g=m[j.path]||"0",(s.dup||"0"===g)&&(m[j.path]="1",S({entry:j,isDup:g})));break}while(v.NextMark);if(!y){var N="search:"+x+n+"path:"+O.join(" ");PPx.Execute('%OP *execute ,%%OP- %*regexp("%('+N+'%)","%(/^search:(?<search>.*)@#_#@path:(?<path>.+)$/'+h+'/%)")')}PPx.Quit(-1)}();
