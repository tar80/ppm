!function(){if("object"!=typeof JSON){JSON={};var t,e,n,r,u=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,a=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,p=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,u,o){var a;if(t="",e="","number"==typeof o)for(a=0;a<o;a+=1)e+=" ";else"string"==typeof o&&(e=o);if(r=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return str("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var n;function walk(t,n){var r,u,o=t[n];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&((u=walk(o,r))!==undefined?o[r]=u:delete o[r]);return e.call(t,n,o)}if(t=String(t),c.lastIndex=0,c.test(t)&&(t=t.replace(c,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(o,"@").replace(a,"]").replace(i,"")))return n=Function("return ("+t+")")(),"function"==typeof e?walk({"":n},""):n;throw new Error("JSON.parse")})}function f(t){return t<10?"0"+t:t}function quote(t){return p.lastIndex=0,p.test(t)?'"'+t.replace(p,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function str(n,u){var o,a,i,p,c,s=t,l=u[n];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(n)),"function"==typeof r&&(l=r.call(u,n,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";if(t+=e,c=[],"[object Array]"===Object.prototype.toString.apply(l)){for(p=l.length,o=0;o<p;o+=1)c[o]=str(String(o),l)||"null";return i=0===c.length?"[]":t?"[\n"+t+c.join(",\n"+t)+"\n"+s+"]":"["+c.join(",")+"]",t=s,i}if(r&&"object"==typeof r)for(p=r.length,o=0;o<p;o+=1)"string"==typeof r[o]&&(i=str(a=String(r[o]),l))&&c.push(quote(a)+(t?": ":":")+i);else for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(i=str(a,l))&&c.push(quote(a)+(t?": ":":")+i);return i=0===c.length?"{}":t?"{\n"+t+c.join(",\n"+t)+"\n"+s+"}":"{"+c.join(",")+"}",t=s,i}return"null"}}();var t=PPx.CreateObject("Scripting.FileSystemObject"),isEmptyStr=function(t){return""===t},e={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},useLanguage=function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"ja"===t?t:e.language},n={tempKey:"K_ppmTemp",tempMenu:"M_ppmTemp",lfDset:"ppmlfdset"},validArgs=function(){for(var t=[],e=PPx.Arguments;!e.atEnd();e.moveNext())t.push(e.value);return t},safeArgs=function(){for(var t=[],e=validArgs(),n=0,r=arguments.length;n<r;n++)t.push(_valueConverter(n<0||arguments.length<=n?undefined:arguments[n],e[n]));return t},_valueConverter=function(t,e){if(null==e||""===e)return null!=t?t:undefined;switch(typeof t){case"number":var n=Number(e);return isNaN(n)?t:n;case"boolean":return"false"!==e&&"0"!==e&&null!=e;default:return e}};t.FileExists(PPx.Extract("%OR %FDC"))&&PPx.Quit(1);var r="@#_#@",main=function(){var e,o,a,i=safeArgs("*ppv","enclose",!1),p=i[0],c=i[1],s=i[2],l=PPx.Extract("%*extract(%%su'"+n.lfDset+"%n')");isEmptyStr(l)&&(PPx.Execute("%Obd echo %*comment|%0ppvw.exe"),PPx.Quit(-1));var h=JSON.parse(l),g=shapeCmdline(h.ppm,p);isEmptyStr(g)&&(PPx.linemessage('!"'+u.noAction),PPx.Quit(-1));var y,d="every"===h.freq,x=null!=(e=h.base)?e:"",m=null!=(o=h.dirtype)?o:"",P=null!=(a=h.search)?a:"",b=/enclose|escape|double/.test(c)?c:"enclose",S=blankHandleSpec(b),O=d?function(t){var e=t.entry,n=t.isDup;return PPx.Execute("%OCP- *execute ,%("+replaceCmdline({cmdline:g,base:x,dirtype:m,search:P,isDup:n,entry:e})+"%)")}:function(t){var e=t.entry;return v.push(e.path)},v=[],N={},j=PPx.Entry;j.FirstMark;do{var E={att:j.Attributes,hl:j.Highlight,path:~j.Comment.indexOf(":")?j.Comment:x+"\\"+j.Comment,sname:j.ShortName};t.FileExists(E.path)&&(~E.path.indexOf(" ")&&(E.path=S(E.path)),y=N[E.path]||"0",(s||"0"===y)&&(N[E.path]="1",O({entry:E,isDup:y})))}while(j.NextMark);if(!d){var C="dup:0"+r+"search:"+P+r+"path:"+v.join(" "),w="^dup:(?<dup>0)"+r+"search:(?<search>.*)"+r+"path:(?<path>.+)$";PPx.Execute('%OP *execute ,%%OP- %*regexp("%('+C+'%)","%(/'+w+"/"+g+'/%)")')}},u={en:{noAction:"No action registered"},ja:{noAction:"対応するコマンドが登録されていません"}}[useLanguage()],shapeCmdline=function(t,e){return(PPx.Extract("%*getcust(S_ppm#actions:"+t+"_"+e+")")||PPx.Extract("%*getcust(S_ppm#actions:all_"+e+")")).replace(/\//g,"\\/")},blankHandleSpec=function(t){return{enclose:function(t){return'"'+t+'"'},double:function(t){return'""'+t+'""'},escape:function(t){return t.replace(/\s/g,"\\ ")}}[t]},replaceCmdline=function(t){var e,n,u=t.cmdline,o=t.base,a=t.dirtype,i=t.search,p=t.isDup,c=t.entry,s=null!=(e=c.att)?e:"",l=c.hl?String(c.hl):"",h=null!=(n=c.sname)?n:"",g="base:"+o+r+"dirtype:"+a+r+"search:"+i+r+"dup:"+p+r+"path:"+c.path+r+"att:"+s+r+"hl:"+l+r+"option:"+h,y="base:(?<base>.*)"+r+"dirtype:(?<type>.*)"+r+"search:(?<search>.*)"+r+"dup:(?<dup>.+)"+r+"path:(?<path>.+)"+r+"att:(?<att>.*)"+r+"hl:(?<hl>.*)"+r+"option:(?<option>.*)";return PPx.Extract('%OP %*regexp("%('+g+'%)","%(/'+y+"/"+u+'/%)")')};main();
