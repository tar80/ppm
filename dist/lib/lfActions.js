!function(){if("object"!=typeof JSON){JSON={};var t,e,n,r,u=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,f=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+p(this.getUTCMonth()+1)+"-"+p(this.getUTCDate())+"T"+p(this.getUTCHours())+":"+p(this.getUTCMinutes())+":"+p(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,u,o){var i;if(t="",e="","number"==typeof o)for(i=0;i<o;i+=1)e+=" ";else"string"==typeof o&&(e=o);if(r=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return l("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var n;if(t=String(t),c.lastIndex=0,c.test(t)&&(t=t.replace(c,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(o,"@").replace(i,"]").replace(a,"")))return n=Function("return ("+t+")")(),"function"==typeof e?function r(t,n){var u,o,i=t[n];if(i&&"object"==typeof i)for(u in i)Object.prototype.hasOwnProperty.call(i,u)&&((o=r(i,u))!==undefined?i[u]=o:delete i[u]);return e.call(t,n,i)}({"":n},""):n;throw new Error("JSON.parse")})}function p(t){return t<10?"0"+t:t}function s(t){return f.lastIndex=0,f.test(t)?'"'+t.replace(f,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function l(n,u){var o,i,a,f,c,p=t,h=u[n];switch(h&&"object"==typeof h&&"function"==typeof h.toJSON&&(h=h.toJSON(n)),"function"==typeof r&&(h=r.call(u,n,h)),typeof h){case"string":return s(h);case"number":return isFinite(h)?String(h):"null";case"boolean":return String(h);case"object":if(!h)return"null";if(t+=e,c=[],"[object Array]"===Object.prototype.toString.apply(h)){for(f=h.length,o=0;o<f;o+=1)c[o]=l(String(o),h)||"null";return a=0===c.length?"[]":t?"[\n"+t+c.join(",\n"+t)+"\n"+p+"]":"["+c.join(",")+"]",t=p,a}if(r&&"object"==typeof r)for(f=r.length,o=0;o<f;o+=1)"string"==typeof r[o]&&(a=l(i=String(r[o]),h))&&c.push(s(i)+(t?": ":":")+a);else for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(a=l(i,h))&&c.push(s(i)+(t?": ":":")+a);return a=0===c.length?"{}":t?"{\n"+t+c.join(",\n"+t)+"\n"+p+"}":"{"+c.join(",")+"}",t=p,a}return"null"}}();var t=PPx.CreateObject("Scripting.FileSystemObject"),e=function(t){return""===t},n="jp",r="ppmlfdset";t.FileExists(PPx.Extract("%OR %FDC"))&&PPx.Quit(1);var u="@#_#@",o={en:{noAction:"No action registered"},jp:{noAction:"対応するコマンドが登録されていません"}}[function(){var t=PPx.Extract("%*getcust(S_ppm#global:lang)");return"en"===t||"jp"===t?t:n}()],i=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["*ppv","enclose","0","utf16le"],n=0,r=t.length;n<r;n++)e[n]=t.Item(n);return/enclose|escape|double/.test(e[1])||(e[1]="enclose"),/sjis|utf8|utf16le/.test(e[3])||(e[3]="utf16le"),{act:e[0],spc:e[1],dup:"0"!==e[2]}},a=function(t,e){return(PPx.Extract("%*getcust(S_ppm#actions:"+t+"_"+e+")")||PPx.Extract("%*getcust(S_ppm#actions:all_"+e+")")).replace(/\//g,"\\/")},f=function(t){return{enclose:function(t){return'"'+t+'"'},double:function(t){return'""'+t+'""'},escape:function(t){return t.replace(/\s/g,"\\ ")}}[t]},c=function(t){var e,n,r=t.cmdline,o=t.base,i=t.dirtype,a=t.search,f=t.isDup,c=t.entry,p=null!=(e=c.att)?e:"",s=c.hl?String(c.hl):"",l=null!=(n=c.sname)?n:"",h="base:"+o+u+"dirtype:"+i+u+"search:"+a+u+"dup:"+f+u+"path:"+c.path+u+"att:"+p+u+"hl:"+s+u+"option:"+l;return PPx.Extract('%OP %*regexp("%('+h+'%)","%(/base:(?<base>.*)@#_#@dirtype:(?<type>.*)@#_#@search:(?<search>.*)@#_#@dup:(?<dup>.+)@#_#@path:(?<path>.+)@#_#@att:(?<att>.*)@#_#@hl:(?<hl>.*)@#_#@option:(?<option>.*)/'+r+'/%)")')};!function(){var n,p,s,l=i(),h=PPx.Extract("%*extract(%%su'"+r+"%n')");e(h)&&(PPx.Execute("%Obd echo %*comment|%0ppvw.exe"),PPx.Quit(-1));var g=JSON.parse(h),y=a(g.ppm,l.act);e(y)&&(PPx.linemessage('!"'+o.noAction),PPx.Quit(-1));var d,x="every"===g.freq,P=null!=(n=g.base)?n:"",b=null!=(p=g.dirtype)?p:"",O=null!=(s=g.search)?s:"",S=f(l.spc),m=x?function(t){var e=t.entry,n=t.isDup;return PPx.Execute("%OCP- *execute ,%("+c({cmdline:y,base:P,dirtype:b,search:O,isDup:n,entry:e})+"%)")}:function(t){var e=t.entry;return v.push(e.path)},v=[],j={},N=PPx.Entry;N.FirstMark;do{var _={att:N.Attributes,hl:N.Highlight,path:~N.Comment.indexOf(":")?N.Comment:P+"\\"+N.Comment,sname:N.ShortName};t.FileExists(_.path)&&(~_.path.indexOf(" ")&&(_.path=S(_.path)),d=j[_.path]||"0",(l.dup||"0"===d)&&(j[_.path]="1",m({entry:_,isDup:d})))}while(N.NextMark);if(!x){var E="dup:0@#_#@search:"+O+u+"path:"+v.join(" ");PPx.Execute('%OP *execute ,%%OP- %*regexp("%('+E+'%)","%(/^dup:(?<dup>0)@#_#@search:(?<search>.*)@#_#@path:(?<path>.+)$/'+y+'/%)")')}}();
