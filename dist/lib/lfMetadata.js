var t,e,r,n;Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(u){if("function"!=typeof u&&("object"!=typeof u||null==u))throw new TypeError("Object.keys: called on non-object");var o,f,i=[];for(o in u)t.call(u,o)&&i.push(o);if(e)for(f=0;f<n;f++)t.call(u,r[f])&&i.push(r[f]);return i}));var u=function(t){if(t===undefined)return!1;if(null===t)return!0;for(var e in t)return!1;return!0};Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var t=[],e=0,r=this.length;e<r;e++){var n=this[e];null!=n&&""!==n&&(n instanceof Array&&0===n.length||n instanceof Object&&u(n)||t.push(n))}return t}),function(){if("object"!=typeof JSON){JSON={};var t,e,r,n,u=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,f=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,a=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(r,u,o){var f;if(t="",e="","number"==typeof o)for(f=0;f<o;f+=1)e+=" ";else"string"==typeof o&&(e=o);if(n=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return s("",{"":r})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var r;if(t=String(t),c.lastIndex=0,c.test(t)&&(t=t.replace(c,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(o,"@").replace(f,"]").replace(i,"")))return r=Function("return ("+t+")")(),"function"==typeof e?function n(t,r){var u,o,f=t[r];if(f&&"object"==typeof f)for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&((o=n(f,u))!==undefined?f[u]=o:delete f[u]);return e.call(t,r,f)}({"":r},""):r;throw new Error("JSON.parse")})}function l(t){return t<10?"0"+t:t}function p(t){return a.lastIndex=0,a.test(t)?'"'+t.replace(a,(function(t){var e=r[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function s(r,u){var o,f,i,a,c,l=t,y=u[r];switch(y&&"object"==typeof y&&"function"==typeof y.toJSON&&(y=y.toJSON(r)),"function"==typeof n&&(y=n.call(u,r,y)),typeof y){case"string":return p(y);case"number":return isFinite(y)?String(y):"null";case"boolean":return String(y);case"object":if(!y)return"null";if(t+=e,c=[],"[object Array]"===Object.prototype.toString.apply(y)){for(a=y.length,o=0;o<a;o+=1)c[o]=s(String(o),y)||"null";return i=0===c.length?"[]":t?"[\n"+t+c.join(",\n"+t)+"\n"+l+"]":"["+c.join(",")+"]",t=l,i}if(n&&"object"==typeof n)for(a=n.length,o=0;o<a;o+=1)"string"==typeof n[o]&&(i=s(f=String(n[o]),y))&&c.push(p(f)+(t?": ":":")+i);else for(f in y)Object.prototype.hasOwnProperty.call(y,f)&&(i=s(f,y))&&c.push(p(f)+(t?": ":":")+i);return i=0===c.length?"{}":t?"{\n"+t+c.join(",\n"+t)+"\n"+l+"}":"{"+c.join(",")+"}",t=l,i}return"null"}}();var o=PPx.CreateObject("Scripting.FileSystemObject"),f=function(t,e){try{var r;return[!1,null!=(r=e())?r:""]}catch(n){return[!0,""]}finally{t.Close()}},i=function(t){var e,r,n,u,i=t.path,a=t.enc,c=void 0===a?"utf8":a,l=t.linefeed,p=function(t){var e=t.path,r=t.enc,n=void 0===r?"utf8":r;if(!o.FileExists(e))return[!0,e+" not found"];var u=o.GetFile(e);if(0===u.Size)return[!0,e+" has no data"];var i=!1,a="";if("utf8"===n){var c=PPx.CreateObject("ADODB.Stream"),l=f(c,(function(){return c.Open(),c.Charset="UTF-8",c.LoadFromFile(e),c.ReadText(-1)}));i=l[0],a=l[1]}else{var p="utf16le"===n?-1:0,s=u.OpenAsTextStream(1,p),y=f(s,(function(){return s.ReadAll()}));i=y[0],a=y[1]}return i?[!0,"Unable to read "+e]:[!1,a]}({path:i,enc:c}),s=p[0],y=p[1];if(s)return[!0,y];l=null!=(e=l)?e:(r=y.slice(0,1e3),n="\n",~(u=r.indexOf("\r"))&&(n="\r\n"==r.substring(u,u+2)?"\r\n":"\r"),n);var g=y.split(l);return""===g[g.length-1]&&g.pop(),[!1,{lines:g,nl:l}]},a=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["","Base","utf16le"],r=0,n=t.length;r<n;r++)e[r]=t.Item(r);return/sjis|utf8|utf16le/.test(e[2])||(e[2]="utf16le"),{path:e[0],id:e[1],enc:e[2]}};PPx.result=function(){var t=a(),e=i({path:t.path,enc:t.enc}),r=e[0],n=e[1];if(function(t,e){return t&&"string"==typeof e}(r,n)){var u=function(){var t,e,r=PPx.ScriptName;return~r.indexOf("\\")?(t=r.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+r+")")):(t=r,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}}(),o=u.scriptName;PPx.report("[ppm/"+o+"] "+n),PPx.Quit(-1)}return function(t){for(var e={},r=/^;([^=]+)=(.+)$/,n=0,u=t.length;n<u&&0===t[n].indexOf(";");n++)t[n].replace(r,(function(t,r,n){if("Base"===r){var u=n.split("|");e.base=u[0],e.dirtype=u[1]}else e[r.toLowerCase()]=n;return""}));return e}(n.lines)[t.id]}();
