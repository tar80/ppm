var t,e,n,r;Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(u){if("function"!=typeof u&&("object"!=typeof u||null==u))throw new Error("Object.keys: called on non-object");var o,i,a=[];for(o in u)t.call(u,o)&&a.push(o);if(e)for(i=0;i<r;i++)t.call(u,n[i])&&a.push(n[i]);return a}));var validArgs=function(){for(var t=[],e=PPx.Arguments;!e.atEnd();e.moveNext())t.push(e.value);return t},safeArgs=function(){for(var t=[],e=validArgs(),n=0,r=arguments.length;n<r;n++)t.push(_valueConverter(n<0||arguments.length<=n?undefined:arguments[n],e[n]));return t},_valueConverter=function(t,e){if(null==e||""===e)return null!=t?t:undefined;switch(typeof t){case"number":var n=Number(e);return isNaN(n)?t:n;case"boolean":return null!=e&&"false"!==e&&"0"!==e;default:return e}},u={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},o=PPx.CreateObject("Scripting.FileSystemObject"),isEmptyStr=function(t){return""===t},isEmptyObj=function(t){if(t===undefined)return!1;if(null===t)return!0;for(var e in t)return!1;return!0},expandNlCode=function(t){var e="\n",n=t.indexOf("\r");return~n&&(e="\r\n"===t.substring(n,n+2)?"\r\n":"\r"),e},confirmFileEncoding=function(t){return"utf8"===t||"sjis"===t?t:u.encode},_exec=function(t,e){try{var n;return[!1,null!=(n=e())?n:""]}catch(r){return[!0,""]}finally{t.Close()}},read=function(t){var e=t.path,n=t.enc,r=void 0===n?"utf8":n;if(!o.FileExists(e))return[!0,e+" not found"];var u=o.GetFile(e);if(0===u.Size)return[!0,e+" has no data"];var i=!1,a="";if("utf8"===r){var l=PPx.CreateObject("ADODB.Stream"),c=_exec(l,(function(){return l.Open(),l.Charset="UTF-8",l.LoadFromFile(e),l.ReadText(-1)}));i=c[0],a=c[1]}else{var s="utf16le"===r?-1:0,p=u.OpenAsTextStream(1,s),y=_exec(p,(function(){return p.ReadAll()}));i=y[0],a=y[1]}return i?[!0,"Unable to read "+e]:[!1,a]},readLines=function(t){var e,n=t.path,r=t.enc,u=void 0===r?"utf8":r,o=t.linefeed,i=read({path:n,enc:u}),a=i[0],l=i[1];if(a)return[!0,l];o=null!=(e=o)?e:expandNlCode(l.slice(0,1e3));var c=l.split(o);return isEmptyStr(c[c.length-1])&&c.pop(),[!1,{lines:c,nl:o}]},pathSelf=function(){var t,e,n=PPx.ScriptName;return~n.indexOf("\\")?(t=extractFileName(n),e=PPx.Extract("%*name(DKN,"+n+")")):(t=n,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}},extractFileName=function(t,e){return void 0===e&&(e="\\"),"\\"!==e&&"/"!==e&&(e="\\"),t.slice(t.lastIndexOf(e)+1)};Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var t=[],e=0,n=this.length;e<n;e++){var r=this[e];null==r||""===r||r instanceof Array&&0===r.length||r instanceof Object&&isEmptyObj(r)||t.push(r)}return t}),function(){if("object"!=typeof JSON){JSON={};var t,e,n,r,u=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,l=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,u,o){var i;if(t="",e="","number"==typeof o)for(i=0;i<o;i+=1)e+=" ";else"string"==typeof o&&(e=o);if(r=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return str("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var n;function walk(t,n){var r,u,o=t[n];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&((u=walk(o,r))!==undefined?o[r]=u:delete o[r]);return e.call(t,n,o)}if(t=String(t),c.lastIndex=0,c.test(t)&&(t=t.replace(c,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(o,"@").replace(i,"]").replace(a,"")))return n=Function("return ("+t+")")(),"function"==typeof e?walk({"":n},""):n;throw new Error("JSON.parse")})}function f(t){return t<10?"0"+t:t}function quote(t){return l.lastIndex=0,l.test(t)?'"'+t.replace(l,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function str(n,u){var o,i,a,l,c,s=t,p=u[n];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(n)),"function"==typeof r&&(p=r.call(u,n,p)),typeof p){case"string":return quote(p);case"number":return isFinite(p)?String(p):"null";case"boolean":return String(p);case"object":if(!p)return"null";if(t+=e,c=[],"[object Array]"===Object.prototype.toString.apply(p)){for(l=p.length,o=0;o<l;o+=1)c[o]=str(String(o),p)||"null";return a=0===c.length?"[]":t?"[\n"+t+c.join(",\n"+t)+"\n"+s+"]":"["+c.join(",")+"]",t=s,a}if(r&&"object"==typeof r)for(l=r.length,o=0;o<l;o+=1)"string"==typeof r[o]&&(a=str(i=String(r[o]),p))&&c.push(quote(i)+(t?": ":":")+a);else for(i in p)Object.prototype.hasOwnProperty.call(p,i)&&(a=str(i,p))&&c.push(quote(i)+(t?": ":":")+a);return a=0===c.length?"{}":t?"{\n"+t+c.join(",\n"+t)+"\n"+s+"}":"{"+c.join(",")+"}",t=s,a}return"null"}}();var getLfMeta=function(t){for(var e={},n=/^;([^=]+)=(.+)$/,r=1,u=t.length;r<u&&0===t[r].indexOf(";");r++)t[r].replace(n,(function(t,n,r){if("Base"===n){var u=r.split("|");e.base=u[0],e.dirtype=u[1]}else e[n.toLowerCase()]=r;return""}));return e},main=function(){var t,e=safeArgs("","base","utf16le"),n=e[0],r=e[1],u=e[2],o=confirmFileEncoding(u),i=readLines({path:n,enc:o}),a=i[0],l=i[1];if(a){var c=pathSelf().scriptName;PPx.report("[ppm/"+c+"] "+l),PPx.Quit(-1)}return null!=(t=getLfMeta(l.lines)[r.toLowerCase()])?t:""};PPx.result=main();
