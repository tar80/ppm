var t=function(t){if(t===undefined)return!1;if(null===t)return!0;for(var e in t)return!1;return!0};Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var e=[],n=0,r=this.length;n<r;n++){var u=this[n];null!=u&&""!==u&&(u instanceof Array&&0===u.length||u instanceof Object&&t(u)||e.push(u))}return e}),function(){if("object"!=typeof JSON){JSON={};var t,e,n,r,u=/^[\],:{}\s]*$/,f=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,u,f){var i;if(t="",e="","number"==typeof f)for(i=0;i<f;i+=1)e+=" ";else"string"==typeof f&&(e=f);if(r=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return s("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var n;if(t=String(t),c.lastIndex=0,c.test(t)&&(t=t.replace(c,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(f,"@").replace(i,"]").replace(o,"")))return n=Function("return ("+t+")")(),"function"==typeof e?function r(t,n){var u,f,i=t[n];if(i&&"object"==typeof i)for(u in i)Object.prototype.hasOwnProperty.call(i,u)&&((f=r(i,u))!==undefined?i[u]=f:delete i[u]);return e.call(t,n,i)}({"":n},""):n;throw new Error("JSON.parse")})}function l(t){return t<10?"0"+t:t}function p(t){return a.lastIndex=0,a.test(t)?'"'+t.replace(a,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function s(n,u){var f,i,o,a,c,l=t,y=u[n];switch(y&&"object"==typeof y&&"function"==typeof y.toJSON&&(y=y.toJSON(n)),"function"==typeof r&&(y=r.call(u,n,y)),typeof y){case"string":return p(y);case"number":return isFinite(y)?String(y):"null";case"boolean":return String(y);case"object":if(!y)return"null";if(t+=e,c=[],"[object Array]"===Object.prototype.toString.apply(y)){for(a=y.length,f=0;f<a;f+=1)c[f]=s(String(f),y)||"null";return o=0===c.length?"[]":t?"[\n"+t+c.join(",\n"+t)+"\n"+l+"]":"["+c.join(",")+"]",t=l,o}if(r&&"object"==typeof r)for(a=r.length,f=0;f<a;f+=1)"string"==typeof r[f]&&(o=s(i=String(r[f]),y))&&c.push(p(i)+(t?": ":":")+o);else for(i in y)Object.prototype.hasOwnProperty.call(y,i)&&(o=s(i,y))&&c.push(p(i)+(t?": ":":")+o);return o=0===c.length?"{}":t?"{\n"+t+c.join(",\n"+t)+"\n"+l+"}":"{"+c.join(",")+"}",t=l,o}return"null"}}();var e=PPx.CreateObject("Scripting.FileSystemObject"),n=function(t,e){try{var n;return[!1,null!=(n=e())?n:""]}catch(r){return[!0,""]}finally{t.Close()}},r=function(t){var r=t.path,u=t.enc,f=function(t){var r=t.path,u=t.enc,f=void 0===u?"utf8":u;if(!e.FileExists(r))return[!0,r+" not found"];var i=e.GetFile(r);if(0===i.Size)return[!0,r+" has no data"];var o=!1,a="";if("utf8"===f){var c=PPx.CreateObject("ADODB.Stream"),l=n(c,(function(){return c.Open(),c.Charset="UTF-8",c.LoadFromFile(r),c.ReadText(-1)}));o=l[0],a=l[1]}else{var p="utf16le"===f?-1:0,s=i.OpenAsTextStream(1,p),y=n(s,(function(){return s.ReadAll()}));o=y[0],a=y[1]}return o?[!0,"Unable to read "+r]:[!1,a]}({path:r,enc:void 0===u?"utf8":u}),i=f[0],o=f[1];if(i)return[!0,o];var a=function(t){var e="\n",n=t.indexOf("\r");return~n&&(e="\r\n"==t.substring(n,n+2)?"\r\n":"\r"),e}(o.slice(0,1e3)),c=o.split(a);return""===c[c.length-1]&&c.pop(),[!1,{lines:c,nl:a}]},u=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["","Base","utf8"],n=0,r=t.length;n<r;n++)e[n]=t.Item(n);return/sjis|utf16le/.test(e[2])||(e[2]="utf8"),{path:e[0],id:e[1],enc:e[2]}};!function(){var t=u(),e=r({path:t.path,enc:t.enc}),n=e[0],f=e[1];if(function(t,e){return t&&"string"==typeof e}(n,f)){var i=function(){var t,e,n=PPx.ScriptName;return~n.indexOf("\\")?(t=n.replace(/^.*\\/,""),e=PPx.Extract("%*name(DKN,"+n+")")):(t=n,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}}(),o=i.scriptName;PPx.report("[ppm/"+o+"] "+f),PPx.Quit(-1)}PPx.result=function(t){for(var e={},n=/^;([^=]+)=(.+)$/,r=0,u=t.length;r<u&&0===t[r].indexOf(";");r++)t[r].replace(n,(function(t,n,r){return e[n.toLowerCase()]=r,""}));return e}(f.lines)[t.id]}();
