var pathSelf=function(){var e,r,t=PPx.ScriptName;return~t.indexOf("\\")?(e=extractFileName(t),r=PPx.Extract("%*name(DKN,"+t+")")):(e=t,r=PPx.Extract("%FDN")),{scriptName:e,parentDir:r.replace(/\\$/,"")}},extractFileName=function(e,r){return void 0===r&&(r="\\"),"\\"!==r&&"/"!==r&&(r="\\"),e.slice(e.lastIndexOf(r)+1)},validArgs=function(){for(var e=[],r=PPx.Arguments;!r.atEnd();r.moveNext())e.push(r.value);return e},main=function(){var e=validArgs();if(0===e.length){var r=pathSelf(),t=r.scriptName,i=r.parentDir;0===PPx.Execute("*script "+i+'\\errors.js",arg,'+t)&&PPx.Quit(-1),PPx.Quit(-1)}return getExists(e)},getExists=function(e){for(var r=PPx.CreateObject("Scripting.FileSystemObject"),t=PPx.Extract("%'path';%0").split(";"),i=[],n="",a=!1,x=0;x<e.length;x++){var P=e[x];if(a=!1,~(n=/\.exe$/.test(P)?P:P+".exe").indexOf(":")&&r.FileExists(n))n=n.replace(/^.+\\(.+)/,"$1"),a=!0;else for(var c=0;c<t.length;c++){var s=t[c];if(r.FileExists(s+"\\"+n)){a=!0;break}}i.push('"'+n+'": '+a)}return"{"+i.join(",")+"}"};PPx.result=main();
