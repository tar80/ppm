const e=PPx.CreateObject("Scripting.FileSystemObject"),t=(t,r)=>{for(const n of r){if(u.recursive>0&&i.length>=u.recursive)return;~n.Name.indexOf(u.pattern)&&i.push(e.BuildPath(t,n.Name))}},r=(n="")=>{const s=e.GetFolder(e.BuildPath(u.path,n)),a=s.SubFolders;if("file"!==u.attribute&&t(n,a),"dir"!==u.attribute&&t(n,s.Files),u.recursive>0){if(i.length>=u.recursive)return;for(const t of a)r(e.BuildPath(n,t.Name))}},i=[],u=((e=PPx.Arguments)=>{const t=["","both","","0"];for(let r=0,i=e.length;r<i;r++)t[r]=e.Item(r);return{path:t[0],attribute:t[1],pattern:t[2],recursive:Number(t[3])}})();r(),PPx.result=i.join(",");
