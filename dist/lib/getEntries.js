var e=PPx.CreateObject("Scripting.FileSystemObject"),validArgs=function(){for(var e=[],t=PPx.Arguments;!t.atEnd();t.moveNext())e.push(t.value);return e},safeArgs=function(){for(var e=[],t=validArgs(),r=0,n=arguments.length;r<n;r++)e.push(_valueConverter(r<0||arguments.length<=r?undefined:arguments[r],t[r]));return e},_valueConverter=function(e,t){if(null==t||""===t)return null!=e?e:undefined;switch(typeof e){case"number":var r=Number(t);return isNaN(r)?e:r;case"boolean":return null!=t&&"false"!==t&&"0"!==t;default:return t}},pathSelf=function(){var e,t,r=PPx.ScriptName;return~r.indexOf("\\")?(e=extractFileName(r),t=PPx.Extract("%*name(DKN,"+r+")")):(e=r,t=PPx.Extract("%FDN")),{scriptName:e,parentDir:t.replace(/\\$/,"")}},extractFileName=function(e,t){return void 0===t&&(t="\\"),"\\"!==t&&"/"!==t&&(t="\\"),e.slice(e.lastIndexOf(t)+1)},main=function(){var e=safeArgs(PPx.Extract("%FD"),"both","",0),t=e[0],r=e[1],n=e[2],a=e[3],u=r.toLowerCase();if(!isSearchSpec(u)){var i=pathSelf(),o=i.scriptName,f=i.parentDir;PPx.Execute('*script "'+f+'\\errors.js",arg,'+o),PPx.Quit(-1)}return getEntries(t,u,n.toLowerCase(),a).join(",")},isSearchSpec=function(e){return"both"===e||"file"===e||"dir"===e},getEntries=function(t,r,n,a){var extractEntries=function(t,r){for(var u=PPx.Enumerator(t);!u.atEnd();u.moveNext()){if(a>0&&i.length>=a)return;~u.Item().Name.toLowerCase().indexOf(n)&&i.push(e.BuildPath(r,u.Item().Name))}},u=function detectItem(n){void 0===n&&(n="");var u=e.GetFolder(e.BuildPath(t,n)),o=u.SubFolders;if("file"!==r&&extractEntries(o,n),"dir"!==r&&extractEntries(u.Files,n),a>0){if(i.length>=a)return;for(var f=0;f<o.length;f++){var c=o[f];detectItem(e.BuildPath(n,c.Name))}}},i=[];return u(),i};PPx.result=main();
