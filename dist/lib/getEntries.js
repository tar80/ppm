var e=PPx.CreateObject("Scripting.FileSystemObject"),validArgs=function(){for(var e=[],r=PPx.Arguments;!r.atEnd();r.moveNext())e.push(r.value);return e},safeArgs=function(){for(var e=[],r=validArgs(),t=0,n=arguments.length;t<n;t++)e.push(_valueConverter(t<0||arguments.length<=t?undefined:arguments[t],r[t]));return e},_valueConverter=function(e,r){if(null==r||""===r)return null!=e?e:undefined;switch(typeof e){case"number":var t=Number(r);return isNaN(t)?e:t;case"boolean":return"false"!==r&&"0"!==r&&null!=r;default:return r}},pathSelf=function(){var e,r,t=PPx.ScriptName;return~t.indexOf("\\")?(e=t.replace(/^.*\\/,""),r=PPx.Extract("%*name(DKN,"+t+")")):(e=t,r=PPx.Extract("%FDN")),{scriptName:e,parentDir:r.replace(/\\$/,"")}},main=function(){var e=safeArgs(PPx.Extract("%FD"),"both","",0),r=e[0],t=e[1],n=e[2],a=e[3],u=t.toLowerCase();if(!isSearchSpec(u)){var i=pathSelf(),o=i.scriptName,c=i.parentDir;PPx.Execute('*script "'+c+'\\errors.js",arg,'+o),PPx.Quit(-1)}return getEntries(r,u,n.toLowerCase(),a).join(",")},isSearchSpec=function(e){return"both"===e||"file"===e||"dir"===e},getEntries=function(r,t,n,a){var extractEntries=function(r,t){for(var u=PPx.Enumerator(r);!u.atEnd();u.moveNext()){if(a>0&&i.length>=a)return;~u.Item().Name.toLowerCase().indexOf(n)&&i.push(e.BuildPath(t,u.Item().Name))}},u=function detectItem(n){void 0===n&&(n="");var u=e.GetFolder(e.BuildPath(r,n)),o=u.SubFolders;if("file"!==t&&extractEntries(o,n),"dir"!==t&&extractEntries(u.Files,n),a>0){if(i.length>=a)return;for(var c=0;c<o.length;c++){var f=o[c];detectItem(e.BuildPath(n,f.Name))}}},i=[];return u(),i};PPx.result=main();
