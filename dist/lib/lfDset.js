var t,e,n,r;Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(u){if("function"!=typeof u&&("object"!=typeof u||null==u))throw new TypeError("Object.keys: called on non-object");var o,f,i=[];for(o in u)t.call(u,o)&&i.push(o);if(e)for(f=0;f<r;f++)t.call(u,n[f])&&i.push(n[f]);return i})),Object.isEmpty||(Object.isEmpty=function(t){if("function"!=typeof t&&("object"!=typeof t||null==t))throw new TypeError("Object.isEmpty: called on non-object");for(var e in t)return!1;return!0});var u=function(t){return""===t},o=function(t){if(t===undefined)return!1;if(null===t)return!0;for(var e in t)return!1;return!0};Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var t=[],e=0,n=this.length;e<n;e++){var r=this[e];null!=r&&""!==r&&(r instanceof Array&&0===r.length||r instanceof Object&&o(r)||t.push(r))}return t}),function(){if("object"!=typeof JSON){JSON={};var t,e,n,r,u=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,f=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,c=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+l(this.getUTCMonth()+1)+"-"+l(this.getUTCDate())+"T"+l(this.getUTCHours())+":"+l(this.getUTCMinutes())+":"+l(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,u,o){var f;if(t="",e="","number"==typeof o)for(f=0;f<o;f+=1)e+=" ";else"string"==typeof o&&(e=o);if(r=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return p("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var n;if(t=String(t),a.lastIndex=0,a.test(t)&&(t=t.replace(a,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(o,"@").replace(f,"]").replace(i,"")))return n=Function("return ("+t+")")(),"function"==typeof e?function r(t,n){var u,o,f=t[n];if(f&&"object"==typeof f)for(u in f)Object.prototype.hasOwnProperty.call(f,u)&&((o=r(f,u))!==undefined?f[u]=o:delete f[u]);return e.call(t,n,f)}({"":n},""):n;throw new Error("JSON.parse")})}function l(t){return t<10?"0"+t:t}function s(t){return c.lastIndex=0,c.test(t)?'"'+t.replace(c,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function p(n,u){var o,f,i,c,a,l=t,y=u[n];switch(y&&"object"==typeof y&&"function"==typeof y.toJSON&&(y=y.toJSON(n)),"function"==typeof r&&(y=r.call(u,n,y)),typeof y){case"string":return s(y);case"number":return isFinite(y)?String(y):"null";case"boolean":return String(y);case"object":if(!y)return"null";if(t+=e,a=[],"[object Array]"===Object.prototype.toString.apply(y)){for(c=y.length,o=0;o<c;o+=1)a[o]=p(String(o),y)||"null";return i=0===a.length?"[]":t?"[\n"+t+a.join(",\n"+t)+"\n"+l+"]":"["+a.join(",")+"]",t=l,i}if(r&&"object"==typeof r)for(c=r.length,o=0;o<c;o+=1)"string"==typeof r[o]&&(i=p(f=String(r[o]),y))&&a.push(s(f)+(t?": ":":")+i);else for(f in y)Object.prototype.hasOwnProperty.call(y,f)&&(i=p(f,y))&&a.push(s(f)+(t?": ":":")+i);return i=0===a.length?"{}":t?"{\n"+t+a.join(",\n"+t)+"\n"+l+"}":"{"+a.join(",")+"}",t=l,i}return"null"}}();var f=PPx.CreateObject("Scripting.FileSystemObject"),i=function(t,e){try{var n;return[!1,null!=(n=e())?n:""]}catch(r){return[!0,""]}finally{t.Close()}},c=function(t){var e,n,r,o,c=t.path,a=t.enc,l=void 0===a?"utf8":a,s=t.linefeed,p=function(t){var e=t.path,n=t.enc,r=void 0===n?"utf8":n;if(!f.FileExists(e))return[!0,e+" not found"];var u=f.GetFile(e);if(0===u.Size)return[!0,e+" has no data"];var o=!1,c="";if("utf8"===r){var a=PPx.CreateObject("ADODB.Stream"),l=i(a,(function(){return a.Open(),a.Charset="UTF-8",a.LoadFromFile(e),a.ReadText(-1)}));o=l[0],c=l[1]}else{var s="utf16le"===r?-1:0,p=u.OpenAsTextStream(1,s),y=i(p,(function(){return p.ReadAll()}));o=y[0],c=y[1]}return o?[!0,"Unable to read "+e]:[!1,c]}({path:c,enc:l}),y=p[0],g=p[1];if(y)return[!0,g];s=null!=(e=s)?e:(n=g.slice(0,1e3),r="\n",~(o=n.indexOf("\r"))&&(r="\r\n"==n.substring(o,o+2)?"\r\n":"\r"),r);var h=g.split(s);return u(h[h.length-1])&&h.pop(),[!1,{lines:h,nl:s}]},a="ppmlfdset"+PPx.Extract("%n"),l=function(t){void 0===t&&(t=PPx.Arguments);for(var e=["","utf16le"],n=0,r=t.length;n<r;n++)e[n]=t.Item(n);return/sjis|utf8|utf16le/.test(e[1])||(e[1]="utf16le"),{style:e[0],enc:e[1]}},s=function(t,e){return u(t)?"":'*viewstyle -temp "'+t+'"'},p=function(t){return~t.indexOf("cmd")?t.replace(/^B\d+,[\-B0-9,]+(.+)$/,(function(t,e){return e.replace(/^.*cmd:"([^"]*)".*$/,"$1")})):""},y=function(t){for(var e=[],n=0,r=Object.keys(t);n<r.length;n++){var u=r[n];e.push('"'+u+'":"'+(t[u].replace(/["\\]/g,(function(t){return{'"':'\\"',"\\":"\\\\"}[t]}))+'"'))}return"{"+e.join(",")+"}"};PPx.result=function(){var t=PPx.Extract("%FDV"),e=PPx.Extract("%*getcust(XC_dset:"+t+")");if(!u(e))return p(e);var n=l(),r=c({path:t,enc:n.enc}),o=r[0],f=r[1];if(function(t,e){return t&&"string"==typeof e}(o,f))return s(n.style);var i=function(t){for(var e={},n=/^;([^=]+)=(.+)$/,r=0,u=t.length;r<u&&0===t[r].indexOf(";");r++)t[r].replace(n,(function(t,n,r){if("Base"===n){var u=r.split("|");e.base=u[0],e.dirtype=u[1]}else e[n.toLowerCase()]=r;return""}));return e}(f.lines);if(Object.isEmpty(i))return s(n.style);var g=!!i.mapkey&&!u(i.mapkey),h={"true":{use:"%:*mapkey use,"+i.mapkey,"delete":"%%:*mapkey delete,"+i.mapkey},"false":{use:"","delete":""}}[g.toString()],O=a+",KC_main";return PPx.Execute("*linecust "+O+':LOADEVENT,*if ("%%n"=="%n")&&(4!=%%*js("PPx.result=PPx.DirectoryType"))%%:*deletecust _User:'+a+h["delete"]+"%%:*linecust "+O+":CLOSEEVENT,%%:*linecust "+O+":LOADEVENT,"),PPx.Execute("*string u,"+a+"="+y(i)+h.use),i.cmd}();
