var validArgs=function(){for(var e=[],r=PPx.Arguments;!r.atEnd();r.moveNext())e.push(r.value);return e},safeArgs=function(){for(var e=[],r=validArgs(),t=0,n=arguments.length;t<n;t++)e.push(_valueConverter(t<0||arguments.length<=t?undefined:arguments[t],r[t]));return e},_valueConverter=function(e,r){if(null==r||""===r)return null!=e?e:undefined;switch(typeof e){case"number":var t=Number(r);return isNaN(t)?e:t;case"boolean":return"false"!==r&&"0"!==r&&null!=r;default:return r}},isEmptyStr=function(e){return""===e},pathSelf=function(){var e,r,t=PPx.ScriptName;return~t.indexOf("\\")?(e=t.replace(/^.*\\/,""),r=PPx.Extract("%*name(DKN,"+t+")")):(e=t,r=PPx.Extract("%FDN")),{scriptName:e,parentDir:r.replace(/\\$/,"")}},e=6e3,r=500,main=function(){var t=PPx.CreateObject("WScript.Shell"),n=safeArgs(undefined,e,"",1),a=n[0],u=n[1],i=n[2],c=n[3];if(null==a){var o=pathSelf(),f=o.scriptName,P=o.parentDir;PPx.Execute("*script "+P+'\\errors.js",arg,'+f),PPx.Quit(-1)}var l=/.+\.exe$/i.test(a)?a:a+".exe",x=processRunning(l);if(PPx.result=x,u>0&&!x){var s=isEmptyStr(i)?l:i;t.Run(s,c);for(var m=0,p=0,v=0,d=r;;){if(m+=r,PPx.Execute("*wait "+(d-Math.floor(d/10))+",2"),m>=u){PPx.linemessage('!"Abort. Waiting time exceeded');break}if(p=Date.now(),x=processRunning(l),v=Date.now(),x)break;d=r-(v-p)}}},t=PPx.CreateObject("WbemScripting.SWbemLocator").ConnectServer(),processRunning=function(e){return t.ExecQuery('SELECT Name FROM Win32_Process WHERE Name = "'+e+'"').Count>0};main();
